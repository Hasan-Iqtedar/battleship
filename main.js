(()=>{"use strict";const e=(()=>{let e=!0;return{isRunning:()=>e,setRunning:t=>{e=t}}})(),t=(()=>{let t=null;const a=document.querySelector(".game-board-container");return{initialize:(r,l,n,o,s,c)=>{const i=document.querySelector("p"),d=document.createElement("div"),u=document.createElement("div");i.textContent="Click on the enemy board to attack",d.classList.add("game-board"),u.classList.add("game-board"),d.id="player-board",a.append(d,u),t=document.querySelector("#player-board");const p=document.getElementsByClassName("game-board");p[0].style.cssText=`grid-template-rows: repeat(${r}, 1fr); grid-template-columns: repeat(${l}, 1fr)`,p[1].style.cssText=`grid-template-rows: repeat(${r}, 1fr); grid-template-columns: repeat(${l}, 1fr)`;const h=a=>{((t,a)=>{const r={x:parseInt(t.target.getAttribute("data-row"),10),y:parseInt(t.target.getAttribute("data-col"),10)};!0===a.receiveAttack(r)?t.target.style.cssText="background-color: maroon":t.target.style.cssText="background-color: rgb(230, 230, 112)",a.allShipsSunk()&&e.setRunning(!1)})(a,s),((a,r,l,n)=>{const o=n.guessRandomCoordinate(a,r);!0===l.receiveAttack(o)?t.querySelectorAll(`[data-row='${o.x}']`).forEach((e=>{e.getAttribute("data-col")==o.y&&(e.style.cssText="background-color: maroon")})):t.querySelectorAll(`[data-row='${o.x}']`).forEach((e=>{e.getAttribute("data-col")==o.y&&(e.style.cssText="background-color: rgb(230, 230, 112)")})),l.allShipsSunk()&&e.setRunning(!1)})(r,l,o,c)},m=()=>{!1===e.isRunning()&&(p[1].childNodes.forEach((e=>{e.removeEventListener("click",h),e.removeEventListener("click",m)})),i.textContent="The End")};for(let e=0;e<r;e++)for(let t=0;t<l;t++){const a=document.createElement("div"),r=document.createElement("div");a.classList.add("cell"),r.classList.add("cell"),a.setAttribute("data-row",`${e}`),r.setAttribute("data-row",`${e}`),a.setAttribute("data-col",`${t}`),r.setAttribute("data-col",`${t}`),r.addEventListener("click",h),r.addEventListener("click",m),n.forEach((r=>{r.coordinates.forEach((r=>{r.x===e&&r.y===t&&(a.style.cssText="background-color: black")}))})),p[0].appendChild(a),p[1].appendChild(r)}}}})(),a=t,r=(()=>{let e="horizontal",t=!1,r=0;const l=["submarine","battleship","fighter","carrier"],n=[4,3,2,3],o=document.querySelector(".game-board-container");let s=n[0],c=l[0];const i=()=>e,d=()=>s,u=()=>c,p=()=>r,h=t=>{e=t},m=()=>{"horizontal"===i()?h("vertical"):h("horizontal")};return{inputShipsToBePlaced:(e,h,g)=>{const y=document.createElement("div"),b=document.createElement("div");y.classList.add("game-board"),b.classList.add("container"),y.style.cssText="grid-template-rows: repeat(10, 1fr); grid-template-columns: repeat(10, 1fr)";const f=document.createElement("button"),x=document.createElement("h2");x.id="input-line",f.classList.add("rotate-btn"),f.addEventListener("click",m),x.textContent="Place your Submarine",f.textContent="Rotate",b.append(x,f),o.append(y,b),((e,h,m,g,y,b)=>{const f=t=>{let a=t.target;const r=a.getAttribute("data-col");if((e=>{let t=!1;if("horizontal"===i())for(let a=0;a<d();a++){if(e.classList.contains("occupied-cell")){t=!0;break}e=e.nextSibling}else{const a=e.getAttribute("data-col");let r=e.getAttribute("data-row"),l=document.querySelectorAll(`[data-row='${parseInt(r,10)+1}']`);for(let n=0;n<d();n++){if(e.classList.contains("occupied-cell")){t=!0;break}l.forEach((t=>{t.getAttribute("data-col")==a&&(e=t)})),r++,l=document.querySelectorAll(`[data-row='${parseInt(r,10)+1}']`)}}return t})(a))a.classList.add("ship-placement-cell-invalid");else if("horizontal"===i())if(r<=m-d())for(let e=0;e<d();e++)a.classList.add("ship-placement-cell"),a=a.nextSibling;else a.classList.add("ship-placement-cell-invalid");else{let t=a.getAttribute("data-row"),l=e.querySelectorAll(`[data-row='${parseInt(t,10)+1}']`);if(t<=h-d())for(let n=0;n<d();n++)a.classList.add("ship-placement-cell"),l.forEach((e=>{e.getAttribute("data-col")==r&&(a=e)})),t++,l=e.querySelectorAll(`[data-row='${parseInt(t,10)+1}']`);else a.classList.add("ship-placement-cell-invalid")}},x=t=>{let a=t.target;const r=a.getAttribute("data-col");if("horizontal"===i())if(r<=m-d())for(let e=0;e<d();e++)a.classList.remove("ship-placement-cell"),a=a.nextSibling;else a.classList.remove("ship-placement-cell-invalid");else{let t=a.getAttribute("data-row"),l=e.querySelectorAll(`[data-row='${parseInt(t,10)+1}']`);for(let n=0;n<d();n++)a.classList.remove("ship-placement-cell"),l.forEach((e=>{e.getAttribute("data-col")==r&&(a=e)})),t++,l=e.querySelectorAll(`[data-row='${parseInt(t,10)+1}']`)}},S=e=>{const i=document.querySelectorAll(".ship-placement-cell"),h=[];var m,f,x;i.forEach((e=>{const t={x:parseInt(e.getAttribute("data-row"),10),y:parseInt(e.getAttribute("data-col"),10)};h.push(t),e.classList.add("occupied-cell"),e.classList.remove("ship-placement-cell")})),h.length>0&&(g.placeShip(u(),d(),h),x=p()+1,r=x,f=l[p()],c=f,m=n[p()],s=m,document.querySelector("#input-line").textContent=`Place your ${u()}`),4===p()&&(t=!0),!0===t&&(o.innerHTML="",a.initialize(10,10,g.getPlayerShips(),g,y,b))};for(let t=0;t<h;t++)for(let a=0;a<m;a++){const r=document.createElement("div");r.classList.add("cell"),r.setAttribute("data-row",`${t}`),r.setAttribute("data-col",`${a}`),r.addEventListener("mouseover",f),r.addEventListener("mouseout",x),r.addEventListener("click",S),e.appendChild(r)}})(y,10,10,e,h,g)}}})(),l=r,n=(e=10,t=10)=>{const a=[],r=[],l=[],n=[];return{rows:e,columns:t,placeShip:(e,t,r)=>{if(Object.keys(r).length!==t)throw new TypeError("Length and num of coordinates mismatch");const o=new class{constructor(e,t){this.type=e,this.length=t,this.coordinates=[],this.hitCoordinates=[]}hit(e){if(-1!==this.hitCoordinates.findIndex((t=>t.x===e.x&&t.y===e.y)))return!1;this.hitCoordinates.push(e)}isSunk(){return 0!==this.coordinates.length&&this.coordinates.length===this.hitCoordinates.length}}(e,t);return o.coordinates.push(...r),a.push(o),r.forEach((e=>{l.push(e.x),n.push(e.y)})),o},receiveAttack:e=>{if(!(0===e.x||0===e.y||e.x&&e.y))throw new TypeError("Bad input invalid coordinate");let t;return-1!==a.findIndex((a=>(t=a.coordinates.findIndex((t=>t.x===e.x&&t.y===e.y)),-1!==t&&(a.hit(e),!0))))||(r.push(e),r)},allShipsSunk:()=>a.every((e=>e.isSunk())),getPlayerShips:()=>a}},o=((e=!1)=>{if(e)return{guessRandomCoordinate:(e,t)=>({x:Math.floor(Math.random()*e),y:Math.floor(Math.random()*t)})}})(!0),s=n(10,10),c=n(10,10),i=[[{x:2,y:2},{x:3,y:2},{x:4,y:2}],[{x:3,y:4},{x:4,y:4},{x:5,y:4},{x:6,y:4}],[{x:8,y:5},{x:8,y:6},{x:8,y:7}],[{x:0,y:5},{x:0,y:6}]];c.placeShip("submarine",3,i[0]),c.placeShip("battleship",4,i[1]),c.placeShip("carrier",3,i[2]),c.placeShip("fighter",2,i[3]),l.inputShipsToBePlaced(s,c,o)})();